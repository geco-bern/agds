<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data visualisation | Applied Geodata Science</title>
  <meta name="description" content="This course prepares you to benefit from the general data richness in environmental and geo-sciences." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data visualisation | Applied Geodata Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This course prepares you to benefit from the general data richness in environmental and geo-sciences." />
  <meta name="github-repo" content="geco-bern/agsd" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data visualisation | Applied Geodata Science" />
  
  <meta name="twitter:description" content="This course prepares you to benefit from the general data richness in environmental and geo-sciences." />
  

<meta name="author" content="Benjamin Stocker, Koen Hufkens, Pepa Arán, and Pascal Schneider" />


<meta name="date" content="2023-11-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="datawrangling.html"/>
<link rel="next" href="datavariety.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Geodata Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#links"><i class="fa fa-check"></i>Links</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite-this-book"><i class="fa fa-check"></i>How to cite this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-course"><i class="fa fa-check"></i>About this course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-goal"><i class="fa fa-check"></i>Course goal</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-contents"><i class="fa fa-check"></i>Course contents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-is-applied-geodata-science"><i class="fa fa-check"></i>What is Applied Geodata Science?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#the-data-science-workflow"><i class="fa fa-check"></i>The data science workflow</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#why-now"><i class="fa fa-check"></i>Why now?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-new-modelling-paradigm"><i class="fa fa-check"></i>A new modelling paradigm</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#reading-and-link-collection"><i class="fa fa-check"></i>Reading and link collection</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="gettingstarted.html"><a href="gettingstarted.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="gettingstarted.html"><a href="gettingstarted.html#learning-objectives-1"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="gettingstarted.html"><a href="gettingstarted.html#tutorial"><i class="fa fa-check"></i><b>1.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="gettingstarted.html"><a href="gettingstarted.html#working-with-r-and-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Working with R and RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="gettingstarted.html"><a href="gettingstarted.html#r-objects"><i class="fa fa-check"></i><b>1.2.2</b> R objects</a></li>
<li class="chapter" data-level="1.2.3" data-path="gettingstarted.html"><a href="gettingstarted.html#r-environment"><i class="fa fa-check"></i><b>1.2.3</b> R environment</a></li>
<li class="chapter" data-level="1.2.4" data-path="gettingstarted.html"><a href="gettingstarted.html#libraries"><i class="fa fa-check"></i><b>1.2.4</b> Libraries</a></li>
<li class="chapter" data-level="1.2.5" data-path="gettingstarted.html"><a href="gettingstarted.html#r-scripts"><i class="fa fa-check"></i><b>1.2.5</b> R scripts</a></li>
<li class="chapter" data-level="1.2.6" data-path="gettingstarted.html"><a href="gettingstarted.html#rmarkdown"><i class="fa fa-check"></i><b>1.2.6</b> R Markdown</a></li>
<li class="chapter" data-level="1.2.7" data-path="gettingstarted.html"><a href="gettingstarted.html#wspmgmt"><i class="fa fa-check"></i><b>1.2.7</b> Workspace management</a></li>
<li class="chapter" data-level="1.2.8" data-path="gettingstarted.html"><a href="gettingstarted.html#setup"><i class="fa fa-check"></i><b>1.2.8</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="gettingstarted.html"><a href="gettingstarted.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#dimensions-of-a-circle"><i class="fa fa-check"></i>Dimensions of a circle</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#sequence-of-numbers"><i class="fa fa-check"></i>Sequence of numbers</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#gauss-sum"><i class="fa fa-check"></i>Gauss sum</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#magic-trick-algorithm"><i class="fa fa-check"></i>Magic trick algorithm</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#vectors-1"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#data-frames-1"><i class="fa fa-check"></i>Data frames</a></li>
<li class="chapter" data-level="" data-path="gettingstarted.html"><a href="gettingstarted.html#workspace"><i class="fa fa-check"></i>Workspace</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programmingprimers.html"><a href="programmingprimers.html"><i class="fa fa-check"></i><b>2</b> Programming primers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programmingprimers.html"><a href="programmingprimers.html#learning-objectives-2"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="programmingprimers.html"><a href="programmingprimers.html#tutorial-1"><i class="fa fa-check"></i><b>2.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="programmingprimers.html"><a href="programmingprimers.html#programming-basics"><i class="fa fa-check"></i><b>2.2.1</b> Programming basics</a></li>
<li class="chapter" data-level="2.2.2" data-path="programmingprimers.html"><a href="programmingprimers.html#style-your-code"><i class="fa fa-check"></i><b>2.2.2</b> Style your code</a></li>
<li class="chapter" data-level="2.2.3" data-path="programmingprimers.html"><a href="programmingprimers.html#findinghelp"><i class="fa fa-check"></i><b>2.2.3</b> Where to find help</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programmingprimers.html"><a href="programmingprimers.html#exercises-1"><i class="fa fa-check"></i><b>2.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="programmingprimers.html"><a href="programmingprimers.html#gauss-variations"><i class="fa fa-check"></i>Gauss variations</a></li>
<li class="chapter" data-level="" data-path="programmingprimers.html"><a href="programmingprimers.html#nested-loops"><i class="fa fa-check"></i>Nested loops</a></li>
<li class="chapter" data-level="" data-path="programmingprimers.html"><a href="programmingprimers.html#interpolation"><i class="fa fa-check"></i>Interpolation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datawrangling.html"><a href="datawrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datawrangling.html"><a href="datawrangling.html#learning-objectives-3"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="datawrangling.html"><a href="datawrangling.html#tutorial-2"><i class="fa fa-check"></i><b>3.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datawrangling.html"><a href="datawrangling.html#example-data"><i class="fa fa-check"></i><b>3.2.1</b> Example data</a></li>
<li class="chapter" data-level="3.2.2" data-path="datawrangling.html"><a href="datawrangling.html#tidyverse"><i class="fa fa-check"></i><b>3.2.2</b> Tidyverse</a></li>
<li class="chapter" data-level="3.2.3" data-path="datawrangling.html"><a href="datawrangling.html#reading-tabular-data"><i class="fa fa-check"></i><b>3.2.3</b> Reading tabular data</a></li>
<li class="chapter" data-level="3.2.4" data-path="datawrangling.html"><a href="datawrangling.html#variable-selection"><i class="fa fa-check"></i><b>3.2.4</b> Variable selection</a></li>
<li class="chapter" data-level="3.2.5" data-path="datawrangling.html"><a href="datawrangling.html#time-objects"><i class="fa fa-check"></i><b>3.2.5</b> Time objects</a></li>
<li class="chapter" data-level="3.2.6" data-path="datawrangling.html"><a href="datawrangling.html#variable-re--definition"><i class="fa fa-check"></i><b>3.2.6</b> Variable (re-) definition</a></li>
<li class="chapter" data-level="3.2.7" data-path="datawrangling.html"><a href="datawrangling.html#axes-of-variation"><i class="fa fa-check"></i><b>3.2.7</b> Axes of variation</a></li>
<li class="chapter" data-level="3.2.8" data-path="datawrangling.html"><a href="datawrangling.html#tidydata"><i class="fa fa-check"></i><b>3.2.8</b> Tidy data</a></li>
<li class="chapter" data-level="3.2.9" data-path="datawrangling.html"><a href="datawrangling.html#aggregating-data"><i class="fa fa-check"></i><b>3.2.9</b> Aggregating data</a></li>
<li class="chapter" data-level="3.2.10" data-path="datawrangling.html"><a href="datawrangling.html#data-cleaning"><i class="fa fa-check"></i><b>3.2.10</b> Data cleaning</a></li>
<li class="chapter" data-level="3.2.11" data-path="datawrangling.html"><a href="datawrangling.html#writing-data-to-csv"><i class="fa fa-check"></i><b>3.2.11</b> Writing data to CSV</a></li>
<li class="chapter" data-level="3.2.12" data-path="datawrangling.html"><a href="datawrangling.html#combining-relational-data"><i class="fa fa-check"></i><b>3.2.12</b> Combining relational data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datawrangling.html"><a href="datawrangling.html#extramaterialwrangling"><i class="fa fa-check"></i><b>3.3</b> Extra material</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datawrangling.html"><a href="datawrangling.html#functional-programming-i"><i class="fa fa-check"></i><b>3.3.1</b> Functional programming I</a></li>
<li class="chapter" data-level="3.3.2" data-path="datawrangling.html"><a href="datawrangling.html#strings"><i class="fa fa-check"></i><b>3.3.2</b> Strings</a></li>
<li class="chapter" data-level="3.3.3" data-path="datawrangling.html"><a href="datawrangling.html#functional-programming-ii"><i class="fa fa-check"></i><b>3.3.3</b> Functional programming II</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datawrangling.html"><a href="datawrangling.html#exerciseswrangling"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="datawrangling.html"><a href="datawrangling.html#star-wars"><i class="fa fa-check"></i>Star wars</a></li>
<li class="chapter" data-level="" data-path="datawrangling.html"><a href="datawrangling.html#aggregating"><i class="fa fa-check"></i>Aggregating</a></li>
<li class="chapter" data-level="" data-path="datawrangling.html"><a href="datawrangling.html#patterns-in-data-quality"><i class="fa fa-check"></i>Patterns in data quality</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datawrangling.html"><a href="datawrangling.html#retidy"><i class="fa fa-check"></i><b>3.5</b> Report Exercise</a>
<ul>
<li class="chapter" data-level="" data-path="datawrangling.html"><a href="datawrangling.html#analyzing-changes-in-soil-organic-matter-during-elevated-co_2-experiments"><i class="fa fa-check"></i>Analyzing changes in soil organic matter during elevated CO<span class="math inline">\(_2\)</span> experiments</a></li>
<li class="chapter" data-level="" data-path="datawrangling.html"><a href="datawrangling.html#deliverables-for-the-report"><i class="fa fa-check"></i>Deliverables for the report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datavis.html"><a href="datavis.html"><i class="fa fa-check"></i><b>4</b> Data visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datavis.html"><a href="datavis.html#learning-objectives-4"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="datavis.html"><a href="datavis.html#tutorial-3"><i class="fa fa-check"></i><b>4.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="datavis.html"><a href="datavis.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>4.2.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="4.2.2" data-path="datavis.html"><a href="datavis.html#every-data-has-its-representation"><i class="fa fa-check"></i><b>4.2.2</b> Every data has its representation</a></li>
<li class="chapter" data-level="4.2.3" data-path="datavis.html"><a href="datavis.html#writing-to-file"><i class="fa fa-check"></i><b>4.2.3</b> Writing to file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="datavis.html"><a href="datavis.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#spurious-data"><i class="fa fa-check"></i>Spurious data</a></li>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#identifying-outliers"><i class="fa fa-check"></i>Identifying Outliers</a></li>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#visualising-diurnal-and-seasonal-cycles-of-gpp"><i class="fa fa-check"></i>Visualising diurnal and seasonal cycles of GPP</a></li>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#trend-in-carbon-dioxide-concentrations"><i class="fa fa-check"></i>Trend in carbon dioxide concentrations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="datavis.html"><a href="datavis.html#report-exercises"><i class="fa fa-check"></i><b>4.4</b> Report Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#telling-a-story-from-data"><i class="fa fa-check"></i>Telling a story from data</a></li>
<li class="chapter" data-level="" data-path="datavis.html"><a href="datavis.html#deliverables-for-the-report-1"><i class="fa fa-check"></i>Deliverables for the report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="datavariety.html"><a href="datavariety.html"><i class="fa fa-check"></i><b>5</b> Data variety</a>
<ul>
<li class="chapter" data-level="5.1" data-path="datavariety.html"><a href="datavariety.html#learning-objectives-5"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="datavariety.html"><a href="datavariety.html#tutorial-4"><i class="fa fa-check"></i><b>5.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="datavariety.html"><a href="datavariety.html#files-and-file-formats"><i class="fa fa-check"></i><b>5.2.1</b> Files and file formats</a></li>
<li class="chapter" data-level="5.2.2" data-path="datavariety.html"><a href="datavariety.html#meta-data"><i class="fa fa-check"></i><b>5.2.2</b> Meta-data</a></li>
<li class="chapter" data-level="5.2.3" data-path="datavariety.html"><a href="datavariety.html#spatial-data-representation"><i class="fa fa-check"></i><b>5.2.3</b> Spatial data representation</a></li>
<li class="chapter" data-level="5.2.4" data-path="datavariety.html"><a href="datavariety.html#online-data-sources"><i class="fa fa-check"></i><b>5.2.4</b> Online data sources</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="datavariety.html"><a href="datavariety.html#exercises-3"><i class="fa fa-check"></i><b>5.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="datavariety.html"><a href="datavariety.html#files-and-file-formats-1"><i class="fa fa-check"></i>Files and file formats</a></li>
<li class="chapter" data-level="" data-path="datavariety.html"><a href="datavariety.html#api-use"><i class="fa fa-check"></i>API use</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="openscience.html"><a href="openscience.html"><i class="fa fa-check"></i><b>6</b> Open science practices</a>
<ul>
<li class="chapter" data-level="6.1" data-path="openscience.html"><a href="openscience.html#learning-objectives-6"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="openscience.html"><a href="openscience.html#tutorial-5"><i class="fa fa-check"></i><b>6.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="openscience.html"><a href="openscience.html#project-structure"><i class="fa fa-check"></i><b>6.2.1</b> Project structure</a></li>
<li class="chapter" data-level="6.2.2" data-path="openscience.html"><a href="openscience.html#managing-workflows"><i class="fa fa-check"></i><b>6.2.2</b> Managing workflows</a></li>
<li class="chapter" data-level="6.2.3" data-path="openscience.html"><a href="openscience.html#capturing-your-session-state"><i class="fa fa-check"></i><b>6.2.3</b> Capturing your session state</a></li>
<li class="chapter" data-level="6.2.4" data-path="openscience.html"><a href="openscience.html#capturing-a-system-state"><i class="fa fa-check"></i><b>6.2.4</b> Capturing a system state</a></li>
<li class="chapter" data-level="6.2.5" data-path="openscience.html"><a href="openscience.html#readable-reporting-using-rmarkdown"><i class="fa fa-check"></i><b>6.2.5</b> Readable reporting using Rmarkdown</a></li>
<li class="chapter" data-level="6.2.6" data-path="openscience.html"><a href="openscience.html#project-structure-1"><i class="fa fa-check"></i><b>6.2.6</b> Project structure</a></li>
<li class="chapter" data-level="6.2.7" data-path="openscience.html"><a href="openscience.html#data-retention"><i class="fa fa-check"></i><b>6.2.7</b> Data retention</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="openscience.html"><a href="openscience.html#exercises-4"><i class="fa fa-check"></i><b>6.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="openscience.html"><a href="openscience.html#external-data"><i class="fa fa-check"></i>External data</a></li>
<li class="chapter" data-level="" data-path="openscience.html"><a href="openscience.html#a-new-project"><i class="fa fa-check"></i>A new project</a></li>
<li class="chapter" data-level="" data-path="openscience.html"><a href="openscience.html#tracking-the-state-of-your-project"><i class="fa fa-check"></i>Tracking the state of your project</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="codemgmt.html"><a href="codemgmt.html"><i class="fa fa-check"></i><b>7</b> Code management</a>
<ul>
<li class="chapter" data-level="7.1" data-path="codemgmt.html"><a href="codemgmt.html#learning-objectives-7"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="codemgmt.html"><a href="codemgmt.html#tutorial-6"><i class="fa fa-check"></i><b>7.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="codemgmt.html"><a href="codemgmt.html#gitworkflow"><i class="fa fa-check"></i><b>7.2.1</b> Git and local version control</a></li>
<li class="chapter" data-level="7.2.2" data-path="codemgmt.html"><a href="codemgmt.html#remote-version-control"><i class="fa fa-check"></i><b>7.2.2</b> Remote version control</a></li>
<li class="chapter" data-level="7.2.3" data-path="codemgmt.html"><a href="codemgmt.html#location-based-code-management---github-templates"><i class="fa fa-check"></i><b>7.2.3</b> Location based code management - github templates</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="codemgmt.html"><a href="codemgmt.html#exercises-5"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="codemgmt.html"><a href="codemgmt.html#location-based-code-management"><i class="fa fa-check"></i>Location based code management</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="codemgmt.html"><a href="codemgmt.html#report-exercises-1"><i class="fa fa-check"></i><b>7.4</b> Report Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="codemgmt.html"><a href="codemgmt.html#collaborative-work-on-github"><i class="fa fa-check"></i>Collaborative Work on Github</a></li>
<li class="chapter" data-level="" data-path="codemgmt.html"><a href="codemgmt.html#deliverables-for-the-report-2"><i class="fa fa-check"></i>Deliverables for the report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regressionclassification.html"><a href="regressionclassification.html"><i class="fa fa-check"></i><b>8</b> Regression and classification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regressionclassification.html"><a href="regressionclassification.html#learning-objectives-8"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="regressionclassification.html"><a href="regressionclassification.html#tutorial-7"><i class="fa fa-check"></i><b>8.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="regressionclassification.html"><a href="regressionclassification.html#types-of-models"><i class="fa fa-check"></i><b>8.2.1</b> Types of models</a></li>
<li class="chapter" data-level="8.2.2" data-path="regressionclassification.html"><a href="regressionclassification.html#regression"><i class="fa fa-check"></i><b>8.2.2</b> Regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="regressionclassification.html"><a href="regressionclassification.html#model-selection"><i class="fa fa-check"></i><b>8.2.3</b> Model selection</a></li>
<li class="chapter" data-level="8.2.4" data-path="regressionclassification.html"><a href="regressionclassification.html#outlier-detection"><i class="fa fa-check"></i><b>8.2.4</b> Outlier detection</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="regressionclassification.html"><a href="regressionclassification.html#extra-material"><i class="fa fa-check"></i><b>8.3</b> Extra material</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regressionclassification.html"><a href="regressionclassification.html#classification"><i class="fa fa-check"></i><b>8.3.1</b> Classification</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regressionclassification.html"><a href="regressionclassification.html#exercises-6"><i class="fa fa-check"></i><b>8.4</b> Exercises</a></li>
<li class="chapter" data-level="8.5" data-path="regressionclassification.html"><a href="regressionclassification.html#report-exercise"><i class="fa fa-check"></i><b>8.5</b> Report Exercise</a>
<ul>
<li class="chapter" data-level="" data-path="regressionclassification.html"><a href="regressionclassification.html#deliverables-for-the-report-3"><i class="fa fa-check"></i>Deliverables for the report</a></li>
<li class="chapter" data-level="" data-path="regressionclassification.html"><a href="regressionclassification.html#guide-for-your-implementation"><i class="fa fa-check"></i>Guide for your implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="supervisedmli.html"><a href="supervisedmli.html"><i class="fa fa-check"></i><b>9</b> Supervised machine learning I</a>
<ul>
<li class="chapter" data-level="9.1" data-path="supervisedmli.html"><a href="supervisedmli.html#learning-objectives-9"><i class="fa fa-check"></i><b>9.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2" data-path="supervisedmli.html"><a href="supervisedmli.html#tutorial-8"><i class="fa fa-check"></i><b>9.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="supervisedmli.html"><a href="supervisedmli.html#what-is-supervised-machine-learning"><i class="fa fa-check"></i><b>9.2.1</b> What is supervised machine learning?</a></li>
<li class="chapter" data-level="9.2.2" data-path="supervisedmli.html"><a href="supervisedmli.html#overfitting"><i class="fa fa-check"></i><b>9.2.2</b> Overfitting</a></li>
<li class="chapter" data-level="9.2.3" data-path="supervisedmli.html"><a href="supervisedmli.html#data-and-the-modelling-challenge"><i class="fa fa-check"></i><b>9.2.3</b> Data and the modelling challenge</a></li>
<li class="chapter" data-level="9.2.4" data-path="supervisedmli.html"><a href="supervisedmli.html#k-nearest-neighbours"><i class="fa fa-check"></i><b>9.2.4</b> K-nearest neighbours</a></li>
<li class="chapter" data-level="9.2.5" data-path="supervisedmli.html"><a href="supervisedmli.html#model-formulation"><i class="fa fa-check"></i><b>9.2.5</b> Model formulation</a></li>
<li class="chapter" data-level="9.2.6" data-path="supervisedmli.html"><a href="supervisedmli.html#data-splitting"><i class="fa fa-check"></i><b>9.2.6</b> Data splitting</a></li>
<li class="chapter" data-level="9.2.7" data-path="supervisedmli.html"><a href="supervisedmli.html#preprocessing"><i class="fa fa-check"></i><b>9.2.7</b> Pre-processing</a></li>
<li class="chapter" data-level="9.2.8" data-path="supervisedmli.html"><a href="supervisedmli.html#putting-it-all-together-half-way"><i class="fa fa-check"></i><b>9.2.8</b> Putting it all together (half-way)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="supervisedmli.html"><a href="supervisedmli.html#exercises-7"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
<li class="chapter" data-level="9.4" data-path="supervisedmli.html"><a href="supervisedmli.html#report-exercises-2"><i class="fa fa-check"></i><b>9.4</b> Report Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="supervisedmli.html"><a href="supervisedmli.html#comparison-of-the-linear-regression-and-knn-models"><i class="fa fa-check"></i>Comparison of the linear regression and KNN models</a></li>
<li class="chapter" data-level="" data-path="supervisedmli.html"><a href="supervisedmli.html#the-role-of-k"><i class="fa fa-check"></i>The role of k</a></li>
<li class="chapter" data-level="" data-path="supervisedmli.html"><a href="supervisedmli.html#deliverables-for-the-report-4"><i class="fa fa-check"></i>Deliverables for the report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="supervisedmlii.html"><a href="supervisedmlii.html"><i class="fa fa-check"></i><b>10</b> Supervised machine learning II</a>
<ul>
<li class="chapter" data-level="10.1" data-path="supervisedmlii.html"><a href="supervisedmlii.html#learning-objectives-10"><i class="fa fa-check"></i><b>10.1</b> Learning objectives</a></li>
<li class="chapter" data-level="10.2" data-path="supervisedmlii.html"><a href="supervisedmlii.html#tutorial-9"><i class="fa fa-check"></i><b>10.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="supervisedmlii.html"><a href="supervisedmlii.html#data-and-the-modelling-challenge-1"><i class="fa fa-check"></i><b>10.2.1</b> Data and the modelling challenge</a></li>
<li class="chapter" data-level="10.2.2" data-path="supervisedmlii.html"><a href="supervisedmlii.html#training"><i class="fa fa-check"></i><b>10.2.2</b> Loss function</a></li>
<li class="chapter" data-level="10.2.3" data-path="supervisedmlii.html"><a href="supervisedmlii.html#hyperparameters"><i class="fa fa-check"></i><b>10.2.3</b> Hyperparameters</a></li>
<li class="chapter" data-level="10.2.4" data-path="supervisedmlii.html"><a href="supervisedmlii.html#resampling"><i class="fa fa-check"></i><b>10.2.4</b> Resampling</a></li>
<li class="chapter" data-level="10.2.5" data-path="supervisedmlii.html"><a href="supervisedmlii.html#validation-versus-testing-data"><i class="fa fa-check"></i><b>10.2.5</b> Validation versus testing data</a></li>
<li class="chapter" data-level="10.2.6" data-path="supervisedmlii.html"><a href="supervisedmlii.html#modeling-with-structured-data"><i class="fa fa-check"></i><b>10.2.6</b> Modeling with structured data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="supervisedmlii.html"><a href="supervisedmlii.html#exercises-8"><i class="fa fa-check"></i><b>10.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="supervisedmlii.html"><a href="supervisedmlii.html#cross-validation-by-hand"><i class="fa fa-check"></i>Cross-validation by hand</a></li>
<li class="chapter" data-level="10.3.1" data-path="supervisedmlii.html"><a href="supervisedmlii.html#cross-validation-vs.-test-error"><i class="fa fa-check"></i><b>10.3.1</b> Cross-validation vs. test error</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="supervisedmlii.html"><a href="supervisedmlii.html#report-exercise-1"><i class="fa fa-check"></i><b>10.4</b> Report Exercise</a>
<ul>
<li class="chapter" data-level="" data-path="supervisedmlii.html"><a href="supervisedmlii.html#deliverables-for-the-report-5"><i class="fa fa-check"></i>Deliverables for the report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforest.html"><a href="randomforest.html"><i class="fa fa-check"></i><b>11</b> Random Forest</a>
<ul>
<li class="chapter" data-level="11.1" data-path="randomforest.html"><a href="randomforest.html#learning-objectives-11"><i class="fa fa-check"></i><b>11.1</b> Learning objectives</a></li>
<li class="chapter" data-level="11.2" data-path="randomforest.html"><a href="randomforest.html#tutorial-10"><i class="fa fa-check"></i><b>11.2</b> Tutorial</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="randomforest.html"><a href="randomforest.html#decision-trees"><i class="fa fa-check"></i><b>11.2.1</b> Decision trees</a></li>
<li class="chapter" data-level="11.2.2" data-path="randomforest.html"><a href="randomforest.html#bagging"><i class="fa fa-check"></i><b>11.2.2</b> Bagging</a></li>
<li class="chapter" data-level="11.2.3" data-path="randomforest.html"><a href="randomforest.html#from-trees-to-a-forest"><i class="fa fa-check"></i><b>11.2.3</b> From trees to a forest</a></li>
<li class="chapter" data-level="11.2.4" data-path="randomforest.html"><a href="randomforest.html#out-of-bag-prediction"><i class="fa fa-check"></i><b>11.2.4</b> Out-of-bag prediction</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randomforest.html"><a href="randomforest.html#exercises-9"><i class="fa fa-check"></i><b>11.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="randomforest.html"><a href="randomforest.html#fitting-a-random-forest"><i class="fa fa-check"></i>Fitting a Random Forest</a></li>
<li class="chapter" data-level="" data-path="randomforest.html"><a href="randomforest.html#hyperparameter-tuning"><i class="fa fa-check"></i>Hyperparameter tuning</a></li>
<li class="chapter" data-level="" data-path="randomforest.html"><a href="randomforest.html#model-performance"><i class="fa fa-check"></i>Model performance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="interpretableml.html"><a href="interpretableml.html"><i class="fa fa-check"></i><b>12</b> Interpretable Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="interpretableml.html"><a href="interpretableml.html#partial-dependence-plots"><i class="fa fa-check"></i><b>12.1</b> Partial dependence plots</a></li>
<li class="chapter" data-level="12.2" data-path="interpretableml.html"><a href="interpretableml.html#variable-importance-from-permutation"><i class="fa fa-check"></i><b>12.2</b> Variable importance from permutation</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>A</b> Solutions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="solutions.html"><a href="solutions.html#getting-started"><i class="fa fa-check"></i><b>A.1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#dimensions-of-a-circle-1"><i class="fa fa-check"></i>Dimensions of a circle</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#sequence-of-numbers-1"><i class="fa fa-check"></i>Sequence of numbers</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#gauss-sum-1"><i class="fa fa-check"></i>Gauss sum</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#magic-trick-algorithm-1"><i class="fa fa-check"></i>Magic trick algorithm</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#vectors-2"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#data-frames-2"><i class="fa fa-check"></i>Data frames</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#workspace-1"><i class="fa fa-check"></i>Workspace</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="solutions.html"><a href="solutions.html#programming-primers"><i class="fa fa-check"></i><b>A.2</b> Programming primers</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#gauss-variations-1"><i class="fa fa-check"></i>Gauss variations</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#nested-loops-1"><i class="fa fa-check"></i>Nested loops</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#interpolation-1"><i class="fa fa-check"></i>Interpolation</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="solutions.html"><a href="solutions.html#data-wrangling"><i class="fa fa-check"></i><b>A.3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#star-wars-1"><i class="fa fa-check"></i>Star wars</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#aggregating-1"><i class="fa fa-check"></i>Aggregating</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#patterns-in-data-quality-1"><i class="fa fa-check"></i>Patterns in data quality</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="solutions.html"><a href="solutions.html#data-visualisation"><i class="fa fa-check"></i><b>A.4</b> Data Visualisation</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#spurious-data-1"><i class="fa fa-check"></i>Spurious data</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#identifying-outliers-1"><i class="fa fa-check"></i>Identifying Outliers</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#visualising-diurnal-and-seasonal-cycles-of-gpp-1"><i class="fa fa-check"></i>Visualising diurnal and seasonal cycles of GPP</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#trend-in-carbon-dioxide-concentrations-1"><i class="fa fa-check"></i>Trend in carbon dioxide concentrations</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="solutions.html"><a href="solutions.html#data-variety"><i class="fa fa-check"></i><b>A.5</b> Data Variety</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#files-and-file-formats-2"><i class="fa fa-check"></i>Files and file formats</a></li>
<li class="chapter" data-level="A.5.1" data-path="solutions.html"><a href="solutions.html#api-use-1"><i class="fa fa-check"></i><b>A.5.1</b> API Use</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="solutions.html"><a href="solutions.html#open-science"><i class="fa fa-check"></i><b>A.6</b> Open Science</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#external-data-1"><i class="fa fa-check"></i>External data</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#a-new-project-1"><i class="fa fa-check"></i>A new project</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#tracking-the-state-of-your-project-1"><i class="fa fa-check"></i>Tracking the state of your project</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="solutions.html"><a href="solutions.html#code-management"><i class="fa fa-check"></i><b>A.7</b> Code Management</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#location-based-code-management-1"><i class="fa fa-check"></i>Location based code management</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="solutions.html"><a href="solutions.html#regression-and-classification"><i class="fa fa-check"></i><b>A.8</b> Regression and Classification</a></li>
<li class="chapter" data-level="A.9" data-path="solutions.html"><a href="solutions.html#supervised-ml-i"><i class="fa fa-check"></i><b>A.9</b> Supervised ML I</a></li>
<li class="chapter" data-level="A.10" data-path="solutions.html"><a href="solutions.html#supervised-ml-ii"><i class="fa fa-check"></i><b>A.10</b> Supervised ML II</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#cross-validation-by-hand-1"><i class="fa fa-check"></i>Cross-validation by hand</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#cross-validation-vs.-test-error-1"><i class="fa fa-check"></i>Cross-validation vs. test error</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="solutions.html"><a href="solutions.html#random-forest"><i class="fa fa-check"></i><b>A.11</b> Random Forest</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#fitting-a-random-forest-1"><i class="fa fa-check"></i>Fitting a Random Forest</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#hyperparameter-tuning-1"><i class="fa fa-check"></i>Hyperparameter tuning</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#model-performance-1"><i class="fa fa-check"></i>Model performance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>B</b> References</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#system-information-and-package-list"><i class="fa fa-check"></i>System information and package list</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Geodata Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datavis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data visualisation<a href="datavis.html#datavis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Chapter lead author: Benjamin Stocker</strong></p>
<div id="learning-objectives-4" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Learning objectives<a href="datavis.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter you will learn how to visualize data for exploration or publication.</p>
<p>You will learn among others the:</p>
<ul>
<li>appropriate choice of visualisations for different data types and different aspects of the data</li>
<li>grammar of graphics, i.e., using the {ggplot2} library</li>
<li>the proper use of colours in visualization</li>
</ul>
</div>
<div id="tutorial-3" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Tutorial<a href="datavis.html#tutorial-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Visualizations often take the center stage of publications and are often the main vehicles for transporting information in scientific publications and (ever more often) in the media. Visualizations communicate data and its patterns in visual form. Visualizing data is also an integral part of the exploratory data analysis cycle. Visually understanding the data guides its transformation and the identification of suitable models and analysis methods.</p>
<p>The quality of a data visualization can be measured by its effectiveness of conveying information about the data and thus of answering a question with the data and telling a story. Different aspects determine this effectiveness, including the appropriateness of visualization elements, the intuitiveness of how information can be decoded from the visualization by the reader, the visual clarity and legibility (taking into account the vision and potential vision deficiencies of the reader), the visual appeal, etc. This tutorial introduces data visualization under the premise that not all aspects of data visualization are a matter of taste. There are appropriate and less appropriate ways of encoding data in visual form.</p>
<p>This tutorial is inspired by the comprehensive and online available textbook Fundamentals of <a href="https://clauswilke.com/dataviz/index.html">Data Visualization by Claus O. Wilke</a>. Another excellent resource is the <a href="https://r4ds.had.co.nz/data-visualisation.html">Chapter Data Visualisation in R for Data Science by Hadley Wickham</a></p>
<div id="the-grammar-of-graphics" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> The grammar of graphics<a href="datavis.html#the-grammar-of-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Chapter <a href="datawrangling.html#datawrangling">3</a>, we learned about axes of variation in the data. For example, time is an axis of variation in our example data <code>half_hourly_fluxes</code>, or site identity and the date are axes of variation in our example data <code>daily_fluxes</code>. We have also learned that we can aggregate over axes of variation, and that we can often separate an axis of variation into a hierarchy of subordinate axes of variation (e.g., years, months, days, and a half-hourly time axis).</p>
<p>In this chapter, we will be working mainly with the same half-hourly time series data of ecosystem-atmosphere fluxes and parallel measurements of meteorological variables - as in Chapters <a href="gettingstarted.html#gettingstarted">1</a> and <a href="datawrangling.html#datawrangling">3</a>. For time series data, the entry point of the exploratory data analysis cycle may be a visualization of some variable of interest (here <code>GPP_NT_VUT_REF</code>) against time:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="datavis.html#cb222-1" aria-hidden="true" tabindex="-1"></a>half_hourly_fluxes <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data/FLX_CH-Lae_FLUXNET2015_FULLSET_HH_2004-2006_CLEAN.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 52608 Columns: 20
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (18): TA_F, SW_IN_F, LW_IN_F, VPD_F, PA_F, P_F, WS_F, GPP_NT_VUT_REF, N...
## dttm  (2): TIMESTAMP_START, TIMESTAMP_END
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="datavis.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(half_hourly_fluxes<span class="sc">$</span>TIMESTAMP_START, half_hourly_fluxes<span class="sc">$</span>GPP_NT_VUT_REF, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-116-1.png" width="672" style="display: block; margin: auto;" /></p>
<blockquote>
<p>To reproduce this code chunk, you can download the file <code>FLX_CH-Lae_FLUXNET2015_FULLSET_HH_2004-2006_CLEAN</code> from <a href="https://raw.githubusercontent.com/geco-bern/agds/main/data/FLX_CH-Lae_FLUXNET2015_FULLSET_HH_2004-2006_CLEAN.csv">here</a> and read it from the local path where the file is stored on your machine. All data files used in this tutorials are stored <a href="https://github.com/geco-bern/agds/tree/main/data">here</a>.</p>
</blockquote>
<p>You may notice the spurious-looking values on the left, in the first third of year 2004. This demonstrates the role of visualisation in understanding the data and its quality. We’ll revisit this point later in this Chapter.</p>
<p>From <a href="https://clauswilke.com/dataviz/">(Wilke)</a>:</p>
<p>“All data visualizations map data values into quantifiable features of the resulting graphic. We refer to these features as <em>aesthetics</em>.”</p>
<p>Applied to our example, the aesthetics are the x-axis and the y-axis of a cartesian coordinate system. <code>TIMESTAMP_START</code> is mapped onto the x-axis, <code>GPP_NT_VUT_REF</code> is mapped onto the y-axis, and their respective values specify the position of points in the cartesian coordinate system that are then connected with lines - making up the geometrical object that represents the data. Often, the aesthetic that is used to plot the target variable against corresponds to a known axis of variation in the data.</p>
<p>The notion of mapping data onto aesthetics and using objects whose geometry is defined by the aesthetics gives rise to the <em>grammar of graphics</em> and to the {ggplot2} R package for data visualisation (which we will use throughout the remainder of this course). The equivalent {ggplot2} code that follows the philosophy of the grammar of graphics is:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="datavis.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> half_hourly_fluxes, <span class="fu">aes</span>(<span class="at">x =</span> TIMESTAMP_START, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb225-2"><a href="datavis.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-117-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The argument provided by the <code>aes()</code> statement specifies the aesthetics (<code>x</code>, and <code>y</code>) and which variables in <code>data</code> are mapped onto them. Once this is specified, we can use any suitable geometrical object that is defined by these aesthetics. Here, we used a line plot specified by <code>geom_line()</code>. Note also that the different objects to creating a ggplot graph are connected with a <code>+</code>, which takes a similar role as the pipe (<code>|&gt;</code>).</p>
<p>The data visualisation above is a dense plot and we cannot distinguish patterns because variations in GPP happen at time scales that are too narrow for displaying three years of half-hourly data in one plot. GPP varies throughout a day just as much as it varies throughout a season. To see this, we can focus on a narrower time span (selecting rows by index using <code>dplyr::slice()</code> in the code below). Visual clarity is also facilitated by an appropriate labeling (title and axes labels using <code>labs()</code>) and by a reduction of displayed elements to a minimum (therefore, the changing of the formatting theme by <code>theme_classic()</code>):</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="datavis.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare plot data</span></span>
<span id="cb226-2"><a href="datavis.html#cb226-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span> </span>
<span id="cb226-3"><a href="datavis.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">24000</span><span class="sc">:</span><span class="dv">25000</span>)</span>
<span id="cb226-4"><a href="datavis.html#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="datavis.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot figure</span></span>
<span id="cb226-6"><a href="datavis.html#cb226-6" aria-hidden="true" tabindex="-1"></a>plotme <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb226-7"><a href="datavis.html#cb226-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> plot_data,</span>
<span id="cb226-8"><a href="datavis.html#cb226-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> TIMESTAMP_START, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb226-9"><a href="datavis.html#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb226-10"><a href="datavis.html#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gross primary productivity&quot;</span>, </span>
<span id="cb226-11"><a href="datavis.html#cb226-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Site: CH-Lae&quot;</span>,</span>
<span id="cb226-12"><a href="datavis.html#cb226-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb226-13"><a href="datavis.html#cb226-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb226-14"><a href="datavis.html#cb226-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb226-15"><a href="datavis.html#cb226-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-16"><a href="datavis.html#cb226-16" aria-hidden="true" tabindex="-1"></a>plotme</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:laegerndemo"></span>
<img src="_main_files/figure-html/laegerndemo-1.png" alt="An example time series created with {ggplot2}." width="672" />
<p class="caption">
Figure 4.1: An example time series created with {ggplot2}.
</p>
</div>
<p>Find a complete reference to {ggplot2} <a href="https://ggplot2.tidyverse.org/">here</a>. The grammar of graphics has found its way also into Python and you can use ggplot using the <em>plotnine</em> Python package (see <a href="https://realpython.com/ggplot-python/">here</a>).</p>
</div>
<div id="every-data-has-its-representation" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Every data has its representation<a href="datavis.html#every-data-has-its-representation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the above example, we mapped two continuous variables (<code>TIMESTAMP_START</code> and <code>GPP_NT_VUT_REF</code>) onto the aesthetics <code>x</code>, and <code>y</code> to visualize time series data. A line plot is an appropriate choice for such data as points are ordered along the time axis and can be connected by a line. Different “geometries” are suitable for visualizing different aspects of the data, and different variable types are suited to mapping onto different aesthetics. Common, available aesthetics are shown in Fig. <a href="datavis.html#fig:common-aesthetics">4.2</a> and can be allocated to variable types:</p>
<ul>
<li>Continuous variables: position, size, color (a color gradient), line width, etc.</li>
<li>Categorical variables: shape, color (a discrete set of colors), line type, etc.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:common-aesthetics"></span>
<img src="figures/common-aesthetics-1.png" alt="Common aesthetics to display different variable types. Figure from [Wilke](https://clauswilke.com/dataviz/aesthetic_mapping_files/figure-html/common-aesthetics-1.png)."  />
<p class="caption">
Figure 4.2: Common aesthetics to display different variable types. Figure from <a href="https://clauswilke.com/dataviz/aesthetic_mapping_files/figure-html/common-aesthetics-1.png">Wilke</a>.
</p>
</div>
<p>Not only the different aesthetics, but also the type of <em>geometry</em> (the layers of the visualization added to a plot by <code>+ geom_*()</code>) goes with certain types of variables and aspects of the data (but not with others). The sub-sections below provide a brief categorization of data visualization types. A more comprehensive overview is given by <a href="http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization#geom_bar-bar-plot">GGPlot2 Essentials for Great Data Visualization in R by Alboukadel Kassambara</a>.</p>
<div id="one-value-per-category" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> One value per category<a href="datavis.html#one-value-per-category" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Probably the simplest case of data visualization is where a single value is shown across a categorical variable. This calls for a bar plot (<code>geom_bar()</code>). In the example below, we plot the mean GPP for each month. The “custom plot” shown below is a demonstration for what you can do by combining different elements with {ggplot2}. Try to understand the command for creating the object <code>plot_2</code>. Both examples are based on the data frame <code>daily_fluxes</code> which we created in Chapter <a href="datawrangling.html#datawrangling">3</a>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="datavis.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in demo daily data</span></span>
<span id="cb227-2"><a href="datavis.html#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as saved in the previous chapter</span></span>
<span id="cb227-3"><a href="datavis.html#cb227-3" aria-hidden="true" tabindex="-1"></a>daily_fluxes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/daily_fluxes.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1096 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (5): GPP_NT_VUT_REF, n_datapoints, n_measured, SW_IN_F, f_measured
## date (1): date
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="datavis.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to monthly</span></span>
<span id="cb229-2"><a href="datavis.html#cb229-2" aria-hidden="true" tabindex="-1"></a>mdf <span class="ot">&lt;-</span> daily_fluxes <span class="sc">|&gt;</span> </span>
<span id="cb229-3"><a href="datavis.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb229-4"><a href="datavis.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="cb229-5"><a href="datavis.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">GPP_NT_VUT_REF =</span> <span class="fu">mean</span>(GPP_NT_VUT_REF))</span>
<span id="cb229-6"><a href="datavis.html#cb229-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-7"><a href="datavis.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb229-8"><a href="datavis.html#cb229-8" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb229-9"><a href="datavis.html#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mdf,</span>
<span id="cb229-10"><a href="datavis.html#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb229-11"><a href="datavis.html#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-12"><a href="datavis.html#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb229-13"><a href="datavis.html#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bar plot&quot;</span>,</span>
<span id="cb229-14"><a href="datavis.html#cb229-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Month&quot;</span>, </span>
<span id="cb229-15"><a href="datavis.html#cb229-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb229-16"><a href="datavis.html#cb229-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-17"><a href="datavis.html#cb229-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom plot</span></span>
<span id="cb229-18"><a href="datavis.html#cb229-18" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb229-19"><a href="datavis.html#cb229-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mdf,</span>
<span id="cb229-20"><a href="datavis.html#cb229-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb229-21"><a href="datavis.html#cb229-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">xend =</span> month, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> GPP_NT_VUT_REF), </span>
<span id="cb229-22"><a href="datavis.html#cb229-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-23"><a href="datavis.html#cb229-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> GPP_NT_VUT_REF), <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;tomato&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-24"><a href="datavis.html#cb229-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> GPP_NT_VUT_REF, <span class="at">label =</span> <span class="fu">format</span>(GPP_NT_VUT_REF, <span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb229-25"><a href="datavis.html#cb229-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-26"><a href="datavis.html#cb229-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb229-27"><a href="datavis.html#cb229-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Custom plot&quot;</span>,</span>
<span id="cb229-28"><a href="datavis.html#cb229-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Month&quot;</span>, </span>
<span id="cb229-29"><a href="datavis.html#cb229-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb229-30"><a href="datavis.html#cb229-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">8.75</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb229-31"><a href="datavis.html#cb229-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb229-32"><a href="datavis.html#cb229-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-33"><a href="datavis.html#cb229-33" aria-hidden="true" tabindex="-1"></a><span class="co"># combine plots</span></span>
<span id="cb229-34"><a href="datavis.html#cb229-34" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plot_1, plot_2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-118-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Above, we created two objects, <code>plot_1</code> and <code>plot_2</code>, that contain the instructions for creating the plots. To combine multiple sub-plots within panels of a single plot, we used <code>cowplot::plot_grid()</code> from the {cowplot} library.</p>
<p>Note also the <code>stat = "identity"</code> specification within the <code>geom_bar()</code> function call. This is required when the bar height is specified by a single value within each category (<code>month</code> in the example above). To visualize not a value <em>per se</em> but the <em>count</em> of values within categories, use <code>stat = "count"</code> to get the equivalent result as when aggregating by taking the number of observations within categories explicitly using the function <code>dplyr::summarise()</code>. This equivalency is demonstrated below.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="datavis.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset plot data and count occurences of bad data (NEE_VUT_REF_QC == 0)</span></span>
<span id="cb230-2"><a href="datavis.html#cb230-2" aria-hidden="true" tabindex="-1"></a>df_count <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span> </span>
<span id="cb230-3"><a href="datavis.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NEE_VUT_REF_QC <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb230-4"><a href="datavis.html#cb230-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(NIGHT) <span class="sc">|&gt;</span> </span>
<span id="cb230-5"><a href="datavis.html#cb230-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb230-6"><a href="datavis.html#cb230-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-7"><a href="datavis.html#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="co"># separate aggregation  </span></span>
<span id="cb230-8"><a href="datavis.html#cb230-8" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(</span>
<span id="cb230-9"><a href="datavis.html#cb230-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_count,</span>
<span id="cb230-10"><a href="datavis.html#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> NIGHT, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb230-11"><a href="datavis.html#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-12"><a href="datavis.html#cb230-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Count via &#39;summarise&#39; and &#39;stat = identiy&#39;&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-13"><a href="datavis.html#cb230-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb230-14"><a href="datavis.html#cb230-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-15"><a href="datavis.html#cb230-15" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data (not summarizing counts)</span></span>
<span id="cb230-16"><a href="datavis.html#cb230-16" aria-hidden="true" tabindex="-1"></a>half_hourly_fluxes_bad <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span> </span>
<span id="cb230-17"><a href="datavis.html#cb230-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NEE_VUT_REF_QC <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb230-18"><a href="datavis.html#cb230-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-19"><a href="datavis.html#cb230-19" aria-hidden="true" tabindex="-1"></a><span class="co"># implicit aggregation by &#39;stat&#39;</span></span>
<span id="cb230-20"><a href="datavis.html#cb230-20" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb230-21"><a href="datavis.html#cb230-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_bad,</span>
<span id="cb230-22"><a href="datavis.html#cb230-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> NIGHT)) <span class="sc">+</span></span>
<span id="cb230-23"><a href="datavis.html#cb230-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-24"><a href="datavis.html#cb230-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Count directly via &#39;stat = count&#39;&quot;</span>) <span class="sc">+</span></span>
<span id="cb230-25"><a href="datavis.html#cb230-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb230-26"><a href="datavis.html#cb230-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-27"><a href="datavis.html#cb230-27" aria-hidden="true" tabindex="-1"></a><span class="co"># combine plots</span></span>
<span id="cb230-28"><a href="datavis.html#cb230-28" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plot_1, plot_2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-119-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="distribution-of-one-variable" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Distribution of one variable<a href="datavis.html#distribution-of-one-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Examining the distribution of a variable is often the first step of exploratory data analysis. A <em>histogram</em> displays the distribution of numerical data by mapping the frequency (or count) of values within discrete bins (equally spaced ranges along the full range values of a given variable) onto the “height” of a bar, and the range of values within bins onto the position of the bar. In other words, it shows the count of how many points of a certain variable (below <code>GPP_NT_VUT_REF</code>) fall into a discrete set of bins. When normalizing (scaling) the “bars” of the histogram to unity, we get a <em>density histogram</em>. To specify the y-axis position of the upper end of the histogram bar as the density, use <code>y = ..density..</code> in the <code>aes()</code> call. To show counts, use <code>y = ..count..</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="datavis.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb231-2"><a href="datavis.html#cb231-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> half_hourly_fluxes,</span>
<span id="cb231-3"><a href="datavis.html#cb231-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> GPP_NT_VUT_REF, <span class="at">y =</span> ..density..)</span>
<span id="cb231-4"><a href="datavis.html#cb231-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb231-5"><a href="datavis.html#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-6"><a href="datavis.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># we can overlay multiple plot layers!</span></span>
<span id="cb231-7"><a href="datavis.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Histogram and density&quot;</span>, </span>
<span id="cb231-8"><a href="datavis.html#cb231-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb231-9"><a href="datavis.html#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-120-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that the red line plotted by <code>geom_density()</code> on top of the density histogram visualises the <em>density distribution</em> in continuous (not discrete, or binned) form. Note also that both “geoms” share the same aesthetics with <code>aes()</code> specified in the <code>ggplot()</code> function call.</p>
</div>
<div id="distributions-within-categories" class="section level4 hasAnchor" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Distributions within categories<a href="datavis.html#distributions-within-categories" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To visualize distributions of a single continuous variable within categories, perhaps the most common visualization type is the <em>box plot</em>. As described in Chapter <a href="datawrangling.html#datawrangling">3</a>, it shows the median (bold line in the center), the upper and lower quartiles, corresponding to the 25% and the 75% quantiles, often referred to as <span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_3\)</span> , and given by the upper and lower edge of the box plot. The lines extending from the box edges visualize the range of <span class="math inline">\(( Q_1 - 1.5 (Q_3 - Q_1)\)</span> to <span class="math inline">\(Q_3 + 1.5 (Q_3 - Q_1)\)</span>. Any point outside this range is plotted by a point.</p>
<p>The box plot is rather reductionist in showing the data (the vector of all values is reduced to the median, <span class="math inline">\(Q_1\)</span> , <span class="math inline">\(Q_3\)</span>, and outlying points) and may yield a distorted picture of the data distribution and does not reflect information about the data volume. For this reason, several journals are now requiring individual data points or at least the number of data points to be shown in addition to each box. Below, points are added by <code>geom_jitter()</code> , where points are “jittered”, that is, randomly spread out along the x-axis. Violin plots are a hybrid of a density plot and a box plot. The shape of their edge is given by the density distribution of the points they represent.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="datavis.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare plot data</span></span>
<span id="cb233-2"><a href="datavis.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1985</span>)  <span class="co"># for random number reproducibility in sample_n() and jitter</span></span>
<span id="cb233-3"><a href="datavis.html#cb233-3" aria-hidden="true" tabindex="-1"></a>half_hourly_fluxes_subset <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span> </span>
<span id="cb233-4"><a href="datavis.html#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">300</span>) <span class="sc">|&gt;</span> </span>
<span id="cb233-5"><a href="datavis.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Night =</span> <span class="fu">ifelse</span>(NIGHT <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb233-6"><a href="datavis.html#cb233-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-7"><a href="datavis.html#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb233-8"><a href="datavis.html#cb233-8" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb233-9"><a href="datavis.html#cb233-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb233-10"><a href="datavis.html#cb233-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Night, <span class="at">y =</span> VPD_F)) <span class="sc">+</span></span>
<span id="cb233-11"><a href="datavis.html#cb233-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-12"><a href="datavis.html#cb233-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-13"><a href="datavis.html#cb233-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;VPD (hPa)&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-14"><a href="datavis.html#cb233-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb233-15"><a href="datavis.html#cb233-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-16"><a href="datavis.html#cb233-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot + jittered points</span></span>
<span id="cb233-17"><a href="datavis.html#cb233-17" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb233-18"><a href="datavis.html#cb233-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb233-19"><a href="datavis.html#cb233-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Night, <span class="at">y =</span> VPD_F)) <span class="sc">+</span></span>
<span id="cb233-20"><a href="datavis.html#cb233-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb233-21"><a href="datavis.html#cb233-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb233-22"><a href="datavis.html#cb233-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot + jitter points&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-23"><a href="datavis.html#cb233-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;VPD (hPa)&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-24"><a href="datavis.html#cb233-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb233-25"><a href="datavis.html#cb233-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-26"><a href="datavis.html#cb233-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Violin plot</span></span>
<span id="cb233-27"><a href="datavis.html#cb233-27" aria-hidden="true" tabindex="-1"></a>plot_3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb233-28"><a href="datavis.html#cb233-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb233-29"><a href="datavis.html#cb233-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Night, <span class="at">y =</span> VPD_F)) <span class="sc">+</span></span>
<span id="cb233-30"><a href="datavis.html#cb233-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-31"><a href="datavis.html#cb233-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Violin plot&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-32"><a href="datavis.html#cb233-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;VPD (hPa)&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-33"><a href="datavis.html#cb233-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb233-34"><a href="datavis.html#cb233-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-35"><a href="datavis.html#cb233-35" aria-hidden="true" tabindex="-1"></a><span class="co"># combine plots</span></span>
<span id="cb233-36"><a href="datavis.html#cb233-36" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plot_1, plot_2, plot_3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-121-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="regression-of-two-continuous-variables" class="section level4 hasAnchor" number="4.2.2.4">
<h4><span class="header-section-number">4.2.2.4</span> Regression of two continuous variables<a href="datavis.html#regression-of-two-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Scatter plots visualize how two variables co-vary. The position of each point in a scatter plot is given by the simultaneously recorded value of two variables, provided in two columns along the same row in a data frame, and mapped onto two dimensions in a cartesian coordinate system. We can also say that two variables are <em>regressed</em> against each other.</p>
<p>In the figure below, we start with a simple scatter plot (a), regressing GPP against shortwave radiation. A visualization is supposed to tell a story with data. The positive and largely linear relationship between shortwave radiation and GPP is expected from theory and our process understanding of the dominant controls on photosynthesis - it’s mainly solar (shortwave) radiation (However, strictly speaking, this is supposed to emerge only at longer time scales, not in half-hourly data). The linear regression line, added by <code>geom_smooth(method = "lm")</code> in (a), indicates that relationship. You will learn more about linear regression in Chapter <a href="regressionclassification.html#regressionclassification">8</a>.</p>
<p>Are there additional variables that modify the relationship between solar radiation and GPP? To visually investigate this, we can map additional variables in our data set onto additional aesthetics. For example, at night, photosynthesis ceases as shown in (b). Here, the variable <code>NIGHT</code> was mapped onto the aesthetic <code>color</code> of same geometry (<code>geom_point()</code>). By default, <code>ggplot()</code> used a <em>continuous color scale</em>, as indicated by the color key on the right. It did so although <code>NIGHT</code> is a categorical (a binary) variable because in the data frame, <code>NIGHT</code> is stored as a numeric value (as can be checked by <code>class(half_hourly_fluxes$NIGHT)</code>). To avoid this, and automatically trigger the use of a color scheme that is suitable for categorical variables, we specify <code>aes(x = SW_IN_F, y = GPP_NT_VUT_REF, color = as.factor(NIGHT))</code> in (c). In (d), temperature, a continuous variable, is mapped onto a continuous color scheme.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="datavis.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare plot data</span></span>
<span id="cb234-2"><a href="datavis.html#cb234-2" aria-hidden="true" tabindex="-1"></a>half_hourly_fluxes_subset <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span></span>
<span id="cb234-3"><a href="datavis.html#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">1000</span>)</span>
<span id="cb234-4"><a href="datavis.html#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="datavis.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a</span></span>
<span id="cb234-6"><a href="datavis.html#cb234-6" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb234-7"><a href="datavis.html#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb234-8"><a href="datavis.html#cb234-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb234-9"><a href="datavis.html#cb234-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb234-10"><a href="datavis.html#cb234-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb234-11"><a href="datavis.html#cb234-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb234-12"><a href="datavis.html#cb234-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb234-13"><a href="datavis.html#cb234-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb234-14"><a href="datavis.html#cb234-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-15"><a href="datavis.html#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="co"># b</span></span>
<span id="cb234-16"><a href="datavis.html#cb234-16" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb234-17"><a href="datavis.html#cb234-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb234-18"><a href="datavis.html#cb234-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF, <span class="at">color =</span> NIGHT)) <span class="sc">+</span></span>
<span id="cb234-19"><a href="datavis.html#cb234-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb234-20"><a href="datavis.html#cb234-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb234-21"><a href="datavis.html#cb234-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb234-22"><a href="datavis.html#cb234-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb234-23"><a href="datavis.html#cb234-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-24"><a href="datavis.html#cb234-24" aria-hidden="true" tabindex="-1"></a><span class="co"># c</span></span>
<span id="cb234-25"><a href="datavis.html#cb234-25" aria-hidden="true" tabindex="-1"></a>plot_3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb234-26"><a href="datavis.html#cb234-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb234-27"><a href="datavis.html#cb234-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF, <span class="at">color =</span> <span class="fu">as.factor</span>(NIGHT))) <span class="sc">+</span></span>
<span id="cb234-28"><a href="datavis.html#cb234-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb234-29"><a href="datavis.html#cb234-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb234-30"><a href="datavis.html#cb234-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb234-31"><a href="datavis.html#cb234-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb234-32"><a href="datavis.html#cb234-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-33"><a href="datavis.html#cb234-33" aria-hidden="true" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb234-34"><a href="datavis.html#cb234-34" aria-hidden="true" tabindex="-1"></a>plot_4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb234-35"><a href="datavis.html#cb234-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> half_hourly_fluxes_subset,</span>
<span id="cb234-36"><a href="datavis.html#cb234-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF, <span class="at">color =</span> TA_F)) <span class="sc">+</span></span>
<span id="cb234-37"><a href="datavis.html#cb234-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb234-38"><a href="datavis.html#cb234-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb234-39"><a href="datavis.html#cb234-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb234-40"><a href="datavis.html#cb234-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb234-41"><a href="datavis.html#cb234-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>()</span>
<span id="cb234-42"><a href="datavis.html#cb234-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-43"><a href="datavis.html#cb234-43" aria-hidden="true" tabindex="-1"></a><span class="co"># combine plots</span></span>
<span id="cb234-44"><a href="datavis.html#cb234-44" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plot_1, plot_2, plot_3, plot_4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="st">&quot;auto&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:regressionplots"></span>
<img src="_main_files/figure-html/regressionplots-1.png" alt="Regression plots." width="672" />
<p class="caption">
Figure 4.3: Regression plots.
</p>
</div>
</div>
<div id="use-of-colors" class="section level4 hasAnchor" number="4.2.2.5">
<h4><span class="header-section-number">4.2.2.5</span> Use of colors<a href="datavis.html#use-of-colors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The above example demonstrates that color schemes have to be chosen depending on the nature of the data. Mapping a continuous variable onto the aesthetics <code>color</code> requires a continuous color scheme to be applied, categorical data requires discrete color schemes. More distinctions should be considered:</p>
<ul>
<li>Continuous variables should be distinguished further if they span a range that includes zero or not. If so, <em>diverging</em> color schemes should be used, where zero appears neutral (e.g., white). If zero is not contained within the range of values in the data, diverging color schemes should be avoided.</li>
<li>Continuous or ordinal variables may be <em>cyclic</em> in nature. For example, hours in a day are cyclic, although there are twelve discrete numbers. The time 00:00 is nearer to 23:59 than it is from, for example, 01:00. The cyclical, or periodical nature of the data should be reflected in the choice of a color scheme where the edges of the range are more similar to one another than they are to the center of the range (see example below)</li>
<li><em>Multisequential</em> color schemes reflect that there is a natural distinction between two parts of the range of continuous values (see example below).</li>
</ul>
<p>Choices of colors and their combination is far from trivial. Colors in color schemes (or “scales”) should be:</p>
<ul>
<li>Distinguishable for people with color vision deficiency</li>
<li>Distinguishable when printed in black and white</li>
<li>Evenly spaced in the color space</li>
<li>Intuitively encoding the information in the data (for example, blue-red for cold-hot)</li>
<li>Visually appealing</li>
</ul>
<p>In (d), we mapped temperature, a continuous variable, onto the color aesthetic of the points and chose the continuous {viridis} color scale by specifying <code>+ scale_color_viridis_c()</code>. The viridis scales have become popular for their respect of the points listed above.</p>
<p>For further reading, several excellent resources exist that theorize and guide the use of color in data visualization. Excellent sources are:</p>
<ul>
<li><a href="https://www.fabiocrameri.ch/colourmaps/">Fabio Crameri’s Scientific colour maps</a>, <a href="https://gmd.copernicus.org/articles/11/2541/2018/">Crameri (2018)</a> and its R package {scico} (on CRAN).</li>
<li><a href="https://personal.sron.nl/~pault/">Paul Tol’s Notes</a>, available for example in the {khroma} R package (on CRAN).</li>
</ul>
</div>
<div id="vis_regr_cat" class="section level4 hasAnchor" number="4.2.2.6">
<h4><span class="header-section-number">4.2.2.6</span> Regression within categories<a href="datavis.html#vis_regr_cat" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the sub-plot (d) above, we may observe a pattern: GPP recorded at low temperatures (dark colored points) tend to be located in the lower range of the cloud of points. We may formulate a hypothesis from this observation, guiding further data analysis and modelling. This illustrates how data visualization is an integral part of any (geo-) data science workflow.</p>
<p>Since the relationship between incoming solar radiation and ecosystem photosynthesis is strongly affected by how much of this light is actually absorbed by leaves, and because the amount of green foliage varies strongly throughout a year (the site CH-Lae from which the data is recorded is located in a mixed forest), the slope of the regression between solar radiation and GPP should change between months.</p>
<p>Hence, let’s consider months as the categories to be used for separating the data and analyzing the bi-variate relationships separately within. Below, two alternatives are presented. Either the data is separated into a grid of sub-plots, or the data is separated by colors within the same plot panel.</p>
<p><strong>Separation by color</strong></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="datavis.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb236-2"><a href="datavis.html#cb236-2" aria-hidden="true" tabindex="-1"></a>daily_fluxes <span class="ot">&lt;-</span> daily_fluxes <span class="sc">|&gt;</span></span>
<span id="cb236-3"><a href="datavis.html#cb236-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>))</span>
<span id="cb236-4"><a href="datavis.html#cb236-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-5"><a href="datavis.html#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb236-6"><a href="datavis.html#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_fluxes,</span>
<span id="cb236-7"><a href="datavis.html#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF, <span class="at">color =</span> month)) <span class="sc">+</span></span>
<span id="cb236-8"><a href="datavis.html#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb236-9"><a href="datavis.html#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">0</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb236-10"><a href="datavis.html#cb236-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb236-11"><a href="datavis.html#cb236-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)) ) <span class="sc">+</span></span>
<span id="cb236-12"><a href="datavis.html#cb236-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb236-13"><a href="datavis.html#cb236-13" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico_d</span>(<span class="at">palette =</span> <span class="st">&quot;romaO&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note three aspects here. First, the color-mapping is specified within <code>aes()</code> in the <code>ggplot()</code> function call and then adopted for all subsequent additions of geoms. Hence, also the <code>geom_smooth()</code> thus takes the color information, and not by a “hard-coded” specification of <code>color =</code> inside the <code>geom_smooth()</code> call as done in Fig. <a href="datavis.html#fig:regressionplots">4.3</a>.</p>
<p>Second, we specified a formula for the linear regression “smooting curve” to force the lines through the origin (<code>y ~ x + 0</code>). This is motivated by our a priori understanding of the process generating the data: when solar radiation is zero, photosynthesis (and hence GPP) should be zero.</p>
<p>Third, we chose a color palette that reflects the cyclic (or periodic) nature of the categories (months). January is closer to December than it is to April. Therefore, their respective colors should also be closer in the <em>color space</em>. An appropriate palette for this is <code>"romaO"</code> from the {scico} package.</p>
<p><strong>Separation into sub-plots</strong></p>
<p>Yet another “mapping” is available with <code>facet_wrap()</code>. It separates the visualisation into different sub-plots, each showing only the part of the data that falls into the respective category, separated by <code>facet_wrap()</code>. Note, this mapping is not dealt with the same way as other aesthetics - not with specifying it with <code>aes()</code>), but with adding the <code>facet_wrap()</code> with a <code>+</code> to the <code>ggplot()</code> object. The variable by which <code>facet_wrap()</code> separates the plot has to be specified as an argument with a preceeding <code>~</code>. Here, this is <code>~month</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="datavis.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb237-2"><a href="datavis.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_fluxes, <span class="co"># reusing the previously subset data (see above)</span></span>
<span id="cb237-3"><a href="datavis.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb237-4"><a href="datavis.html#cb237-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb237-5"><a href="datavis.html#cb237-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">0</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb237-6"><a href="datavis.html#cb237-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb237-7"><a href="datavis.html#cb237-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)) ) <span class="sc">+</span></span>
<span id="cb237-8"><a href="datavis.html#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>month)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-123-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You may object here that a linear regression is not a good model for our data. Instead, the relationship looks saturating, as indicated for example by the data in August. But we’ll get to modelling in later chapters. Nevertheless, the two visualizations above confirm our suspicion that the light-GPP relationship varies between months - a demonstration for why data visualization is an integral part of the scientific process.</p>
</div>
<div id="time-series" class="section level4 hasAnchor" number="4.2.2.7">
<h4><span class="header-section-number">4.2.2.7</span> Time series<a href="datavis.html#time-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A time series plot can be regarded as a special case of a regression of two variables. In this case, one variable is regressed against time. A defining aspect of time is that there is a natural order in time steps. Therefore, it makes sense to visualize temporal data using lines that connect the points using <code>geom_line()</code>. The example below shows the time series of daily GPP in three years.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="datavis.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb238-2"><a href="datavis.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_fluxes,</span>
<span id="cb238-3"><a href="datavis.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb238-4"><a href="datavis.html#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb238-5"><a href="datavis.html#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Line plot&quot;</span>, </span>
<span id="cb238-6"><a href="datavis.html#cb238-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb238-7"><a href="datavis.html#cb238-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb238-8"><a href="datavis.html#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-124-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the line plot above, we see a spurious-looking part of the time series in the first third of year 2004. Is this bad data that should be removed? Also, in winter of 2005/2005, some daily GPP values appear as high as a typical summer level of GPP. Is this bad data? Remember, that in Chapter <a href="datawrangling.html#datawrangling">3</a>, we aggregated the half-hourly <code>half_hourly_fluxes</code> data frame to a daily data frame <code>daily_fluxes</code> from which data is visualized above. The aggregation kept a record of the fraction of actually measured (not gap-filled) half-hourly data points per day (<code>f_measured</code>). This yields a “data quality axis”. Is there a pattern between <code>f_measured</code> and the presumably bad data? Discerning such patterns is often only possible with a suitable visualization. What is suitable here?</p>
<p>A solution is to “map” <code>f_measured</code> to the color axis. When adding such an additional mapping to visualisation dimensions (“aesthetics”), we have to specify it using <code>aes()</code>. This only affects the points and the color of points, while the lines and points and their position in x-y space is shared. Hence, we write <code>aes(x = date, y = GPP_NT_VUT_REF)</code> in the <code>ggplot()</code> function call (indicating that all subsequent additions of <code>geom_</code> layers share this x-y mapping); while <code>aes(color = f_measured)</code> is specified only in the <code>geom_point()</code> layer.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="datavis.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb239-2"><a href="datavis.html#cb239-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> daily_fluxes,</span>
<span id="cb239-3"><a href="datavis.html#cb239-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb239-4"><a href="datavis.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb239-5"><a href="datavis.html#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> f_measured), <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb239-6"><a href="datavis.html#cb239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb239-7"><a href="datavis.html#cb239-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb239-8"><a href="datavis.html#cb239-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co"># inverse color scale is more intuitive here</span></span>
<span id="cb239-9"><a href="datavis.html#cb239-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We observe the presumably bad data appear in yellow, and are therefore indeed characterised with a particularly low fraction of actually measured data from which their values are derived. This is an insight we would never have reached by just looking at the naked values in our data frames. Data visualizations are essential for guiding analyses and data processing throughout all steps. Having learned this, we now have a justification for applying further data filtering criteria.</p>
</div>
<div id="periodic-data" class="section level4 hasAnchor" number="4.2.2.8">
<h4><span class="header-section-number">4.2.2.8</span> Periodic data<a href="datavis.html#periodic-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The seasons are an important axis of variation in our data. Hence our data are periodic - with a periodicity of 365 days in the <code>daily_fluxes</code> dataset and with both 12 hours and 365 days in the <code>half_hourly_fluxes</code> dataset. A polar coordinate system, instead of a cartesian system, lends itself to displaying periodic data. A polar coordinate system reflects the fact that, for example, January 1st is closer to December 31st, although they are located on the extreme end of a linear spectrum of days in a year. In a polar coordinate system, the x-axis spans the angle (360<span class="math inline">\(^\circ\)</span>, like a clock), while the y-axis spans the radius (distance from the center). This is specified by changing the coordinate system of the ggplot object by <code>+ coord_polar()</code>.</p>
<p>Below, we first aggregate the data to get a mean seasonal cycle from <code>daily_fluxes</code> (a, b), and to get a mean diurnal (daily) cycle from June data in <code>half_hourly_fluxes</code> (c, d). To get the mean seasonal cycle, we first determine the day-of-year (counting from 1 for January first to 365 for December 31st) using the {lubridate} function <code>yday()</code>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="datavis.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare plot data</span></span>
<span id="cb240-2"><a href="datavis.html#cb240-2" aria-hidden="true" tabindex="-1"></a>daily_mean_fluxes <span class="ot">&lt;-</span> daily_fluxes <span class="sc">|&gt;</span></span>
<span id="cb240-3"><a href="datavis.html#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doy =</span> <span class="fu">yday</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb240-4"><a href="datavis.html#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doy) <span class="sc">|&gt;</span> </span>
<span id="cb240-5"><a href="datavis.html#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">GPP_NT_VUT_REF =</span> <span class="fu">mean</span>(GPP_NT_VUT_REF))</span>
<span id="cb240-6"><a href="datavis.html#cb240-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-7"><a href="datavis.html#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal cycle, cartesian</span></span>
<span id="cb240-8"><a href="datavis.html#cb240-8" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb240-9"><a href="datavis.html#cb240-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_mean_fluxes,</span>
<span id="cb240-10"><a href="datavis.html#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(doy, GPP_NT_VUT_REF)) <span class="sc">+</span> </span>
<span id="cb240-11"><a href="datavis.html#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb240-12"><a href="datavis.html#cb240-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb240-13"><a href="datavis.html#cb240-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Day of year&quot;</span>)</span>
<span id="cb240-14"><a href="datavis.html#cb240-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-15"><a href="datavis.html#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal cycle, polar</span></span>
<span id="cb240-16"><a href="datavis.html#cb240-16" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb240-17"><a href="datavis.html#cb240-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_mean_fluxes,</span>
<span id="cb240-18"><a href="datavis.html#cb240-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(doy, GPP_NT_VUT_REF)) <span class="sc">+</span> </span>
<span id="cb240-19"><a href="datavis.html#cb240-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb240-20"><a href="datavis.html#cb240-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span> </span>
<span id="cb240-21"><a href="datavis.html#cb240-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb240-22"><a href="datavis.html#cb240-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Day of year&quot;</span>)</span>
<span id="cb240-23"><a href="datavis.html#cb240-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-24"><a href="datavis.html#cb240-24" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare plot data (diurnal step)</span></span>
<span id="cb240-25"><a href="datavis.html#cb240-25" aria-hidden="true" tabindex="-1"></a>daily_mean_hourly_fluxes <span class="ot">&lt;-</span> half_hourly_fluxes <span class="sc">|&gt;</span></span>
<span id="cb240-26"><a href="datavis.html#cb240-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(TIMESTAMP_START)) <span class="sc">|&gt;</span> </span>
<span id="cb240-27"><a href="datavis.html#cb240-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">|&gt;</span>  <span class="co"># taking only June data</span></span>
<span id="cb240-28"><a href="datavis.html#cb240-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hour =</span> <span class="fu">hour</span>(TIMESTAMP_START)) <span class="sc">|&gt;</span> </span>
<span id="cb240-29"><a href="datavis.html#cb240-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hour) <span class="sc">|&gt;</span> </span>
<span id="cb240-30"><a href="datavis.html#cb240-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">GPP_NT_VUT_REF =</span> <span class="fu">mean</span>(GPP_NT_VUT_REF))</span>
<span id="cb240-31"><a href="datavis.html#cb240-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-32"><a href="datavis.html#cb240-32" aria-hidden="true" tabindex="-1"></a><span class="co"># diurnal cycle, cartesian</span></span>
<span id="cb240-33"><a href="datavis.html#cb240-33" aria-hidden="true" tabindex="-1"></a>plot_3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb240-34"><a href="datavis.html#cb240-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> daily_mean_hourly_fluxes,</span>
<span id="cb240-35"><a href="datavis.html#cb240-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(hour, GPP_NT_VUT_REF)) <span class="sc">+</span> </span>
<span id="cb240-36"><a href="datavis.html#cb240-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb240-37"><a href="datavis.html#cb240-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb240-38"><a href="datavis.html#cb240-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Hour of day&quot;</span>)</span>
<span id="cb240-39"><a href="datavis.html#cb240-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-40"><a href="datavis.html#cb240-40" aria-hidden="true" tabindex="-1"></a><span class="co"># diurnal cycle, polar</span></span>
<span id="cb240-41"><a href="datavis.html#cb240-41" aria-hidden="true" tabindex="-1"></a>plot_4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb240-42"><a href="datavis.html#cb240-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_mean_hourly_fluxes,</span>
<span id="cb240-43"><a href="datavis.html#cb240-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(hour, GPP_NT_VUT_REF)) <span class="sc">+</span> </span>
<span id="cb240-44"><a href="datavis.html#cb240-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb240-45"><a href="datavis.html#cb240-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span> </span>
<span id="cb240-46"><a href="datavis.html#cb240-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb240-47"><a href="datavis.html#cb240-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Hour of day&quot;</span>)</span>
<span id="cb240-48"><a href="datavis.html#cb240-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-49"><a href="datavis.html#cb240-49" aria-hidden="true" tabindex="-1"></a><span class="co"># combine plots</span></span>
<span id="cb240-50"><a href="datavis.html#cb240-50" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plot_1, plot_2, plot_3, plot_4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="st">&quot;auto&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-126-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="regressiondensity" class="section level4 hasAnchor" number="4.2.2.9">
<h4><span class="header-section-number">4.2.2.9</span> Density along two continuous variables<a href="datavis.html#regressiondensity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Scatter plots can appear “overcrowded” when points are plotted on top of each other and potentially important information is lost in the visualization.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="datavis.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb241-2"><a href="datavis.html#cb241-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> half_hourly_fluxes,</span>
<span id="cb241-3"><a href="datavis.html#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb241-4"><a href="datavis.html#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb241-5"><a href="datavis.html#cb241-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb241-6"><a href="datavis.html#cb241-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb241-7"><a href="datavis.html#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To avoid obscuring important details about the data, we may want to visualise the <em>density</em> of points. We want to plot how many points fall within bins of a certain range of values in GPP and shortwave radiation, or, in other words, within grid cells in the GPP-radiation space. We can visualize the data, for example, with a raster plot that measures the density using <code>stat_density_2d()</code> or with a binning into hexagonal cells using the simple <code>geom_hex()</code> layer.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="datavis.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density raster</span></span>
<span id="cb242-2"><a href="datavis.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb242-3"><a href="datavis.html#cb242-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> daily_fluxes,</span>
<span id="cb242-4"><a href="datavis.html#cb242-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb242-5"><a href="datavis.html#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(</span>
<span id="cb242-6"><a href="datavis.html#cb242-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;raster&quot;</span>, <span class="co"># the geometric object to display the data</span></span>
<span id="cb242-7"><a href="datavis.html#cb242-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">after_stat</span>(density)), <span class="co"># using `density`, a variable calculated by the stat</span></span>
<span id="cb242-8"><a href="datavis.html#cb242-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">contour =</span> <span class="cn">FALSE</span> </span>
<span id="cb242-9"><a href="datavis.html#cb242-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb242-10"><a href="datavis.html#cb242-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb242-11"><a href="datavis.html#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb242-12"><a href="datavis.html#cb242-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)) ) <span class="sc">+</span></span>
<span id="cb242-13"><a href="datavis.html#cb242-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb242-14"><a href="datavis.html#cb242-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span>  <span class="co"># avoid gap between plotting area and axis</span></span>
<span id="cb242-15"><a href="datavis.html#cb242-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="datavis.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density hexagonal bins</span></span>
<span id="cb243-2"><a href="datavis.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb243-3"><a href="datavis.html#cb243-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> daily_fluxes,</span>
<span id="cb243-4"><a href="datavis.html#cb243-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> SW_IN_F, <span class="at">y =</span> GPP_NT_VUT_REF)) <span class="sc">+</span></span>
<span id="cb243-5"><a href="datavis.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb243-6"><a href="datavis.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb243-7"><a href="datavis.html#cb243-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Shortwave radiation (W m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>)), </span>
<span id="cb243-8"><a href="datavis.html#cb243-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP (&quot;</span>, mu,<span class="st">&quot;mol CO&quot;</span>[<span class="dv">2</span>], <span class="st">&quot; m&quot;</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">&quot;s&quot;</span><span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>)) ) <span class="sc">+</span></span>
<span id="cb243-9"><a href="datavis.html#cb243-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>An alternative solution to “overplotting” points is described in <a href="https://geco-group.org/post/lsd/">this blog post</a>.</p>
</div>
<div id="raster-data" class="section level4 hasAnchor" number="4.2.2.10">
<h4><span class="header-section-number">4.2.2.10</span> Raster data<a href="datavis.html#raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the figure above, the density of points in a grid of equally spaced bins along two axes, one for each variable, was shown. Often, data is organised along a grid of equally spaced bins by nature - think a matrix or raster data. Examples of such data are climate model outputs (which often span more than two dimensions), remote sensing images (again, just one “layer” of an image or one “band”), or images in general. In these cases, two (often spatial) axes span the space of a cartesian coordinate system and the value within each pixel is mapped onto the <code>color</code> aesthetic.</p>
<p>The base-R function <code>image()</code> can be used to visualize such spatial data as images.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="datavis.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(volcano)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-129-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>{ggplot2} forces us to the data frame paradigm and therefore doesn’t lend itself naturally to raster data. We can, however, convert raster data into a data frame in a separate step.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="datavis.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example from https://github.com/thomasp85/scico</span></span>
<span id="cb245-2"><a href="datavis.html#cb245-2" aria-hidden="true" tabindex="-1"></a>df_volcano <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb245-3"><a href="datavis.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">ncol</span>(volcano)), <span class="at">each =</span> <span class="fu">nrow</span>(volcano)),</span>
<span id="cb245-4"><a href="datavis.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(volcano)), <span class="fu">ncol</span>(volcano)),</span>
<span id="cb245-5"><a href="datavis.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(volcano) <span class="sc">-</span> <span class="dv">140</span>  <span class="co"># subtract 140 for example below</span></span>
<span id="cb245-6"><a href="datavis.html#cb245-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb245-7"><a href="datavis.html#cb245-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-8"><a href="datavis.html#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb245-9"><a href="datavis.html#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_volcano,</span>
<span id="cb245-10"><a href="datavis.html#cb245-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> height)) <span class="sc">+</span> </span>
<span id="cb245-11"><a href="datavis.html#cb245-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span> </span>
<span id="cb245-12"><a href="datavis.html#cb245-12" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&#39;bukavu&#39;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb245-13"><a href="datavis.html#cb245-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb245-14"><a href="datavis.html#cb245-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-130-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In this example, we used the <em>multisequential</em> <code>"bukavu"</code> color scale from the {scico} package to reflect values above 0 (e.g., elevation above the sea level) and below 0 (ocean depth).</p>
</div>
<div id="geospatial-data" class="section level4 hasAnchor" number="4.2.2.11">
<h4><span class="header-section-number">4.2.2.11</span> Geospatial data<a href="datavis.html#geospatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Raster data often reflects values in geographic space. Also points and polygons may be located in geographic space. This opens the door to geospatial data visualisation (a.k.a. creating maps) which does not form part of this course.</p>
<p>Interested readers can find more content on geospatial data visualisation here:</p>
<ul>
<li>Timo Grossenbacher’s blog on geographic data journalism (<a href="https://timogrossenbacher.ch/blog/">link</a>)</li>
<li>Koen Hufken’s blog containing various <a href="https://bluegreenlabs.org/categories/visualization/">worked example</a>.</li>
</ul>
</div>
</div>
<div id="writing-to-file" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Writing to file<a href="datavis.html#writing-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plots can be saved in figure files in any common format. To write the figure that was rendered last into a file, call the <code>ggsave(filename)</code> function. The format of the image is automatically determined based on <code>filename</code>. E.g., a PDF is created if the <code>filename</code> is. For example,</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="datavis.html#cb246-1" aria-hidden="true" tabindex="-1"></a>plotme</span>
<span id="cb246-2"><a href="datavis.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./figures/plot_gpp.pdf&quot;</span>)</span></code></pre></div>
<p>… saves the plot generated by printing <code>plotme</code> (created in the code chunk preceeding Fig. <a href="datavis.html#fig:laegerndemo">4.1</a>) into a PDF located in the appropriate (see also <a href="gettingstarted.html#rprojects">1.2.7.1</a> what’s “appropriate”) sub-directory. Plots are ideally saved as <a href="https://en.wikipedia.org/wiki/Vector_graphics"><em>vector graphics</em></a> - the types of graphics that are defined by geometric shapes (polygons, lines, points), not rasters. Vector graphics never look “pixelated”. When saving a <code>ggplot</code> object as PDF, it’s saved as a vector graphic. Other vector graphics formats are <code>.eps</code>, or <code>.svg</code>. Beware however, when plotting very large numbers points, lines, or polygons, file sizes can get excessively large and render very slowly. In such cases, consider representing the <em>density</em> of overlaying points which creates a vector graphics, e.g., of rectangles (raster), hexagons, or other polygons (see Sec. <a href="datavis.html#regressiondensity">4.2.2.9</a>). Alternatively, plots may be saved as a raster image (e.g., PNG with files ending on <code>.png</code>, giving the option to manually set the resolution with the argument <code>dpi</code>) or a compressed image format (e.g, JPEG). When rendering an RMarkdown file, figures are placed in the output and, unless explicitly triggered with a <code>ggsave()</code> call inside an executed code chunk, no separate figure files are created.</p>
</div>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Exercises<a href="datavis.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="spurious-data" class="section level3 unnumbered hasAnchor">
<h3>Spurious data<a href="datavis.html#spurious-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="datawrangling.html#baddata">3.2.10.2</a>, we discovered that certain values of <code>GPP_NT_VUT_REF</code> in the half-hourly data <code>half_hourly_fluxes</code> (to be read from file <code>data/FLX_CH-Lae_FLUXNET2015_FULLSET_HH_2004-2006.csv</code>) are repeated with a spuriously high frequency. Determine all values of <code>GPP_NT_VUT_REF</code> that appear more than once in <code>half_hourly_fluxes</code> and label them as being “spurious”. Visualise the time series of the first year of half-hourly GPP, mapping the information whether the data is spurious or not to the <em>color</em> aesthetic.</p>
<p>Then aggregate half-hourly to daily data, taking the mean of <code>GPP_NT_VUT_REF</code> and recording the proportion of underlying half-hourly data points that are “spurious”. Visualise the time series of daily <code>GPP_NT_VUT_REF</code> with the color scale indicating the proportion of spurious half-hourly data that was used for determining the respective date’s mean GPP.</p>
<blockquote>
<p>Hint: The base-R function <code>duplicated(df, ...)</code> takes a data frame <code>df</code> as input and returns a logical vector of length <code>nrow(df)</code> specifying whether a row has an exact duplicate in the same data frame.</p>
</blockquote>
</div>
<div id="identifying-outliers" class="section level3 unnumbered hasAnchor">
<h3>Identifying Outliers<a href="datavis.html#identifying-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key part of data cleaning is to detect and understand outliers. Visualisations can help. Your task here is to find outliers in <code>GPP_NT_VUT_REF</code>.</p>
<p>First, using the half-hourly fluxes data, determine “outliers” as those values of <code>GPP_NT_VUT_REF</code> that fall outside <span class="math inline">\(( Q_1 - 1.5 (Q_3 - Q_1)\)</span> to <span class="math inline">\(Q_3 + 1.5 (Q_3 - Q_1)\)</span>. Plot <code>GPP_NT_VUT_REF</code> versus shortwave radiation and highlight outliers in red.</p>
<blockquote>
<p>Hint: Use <code>boxplot.stats()</code> to return a list containing a vector of the data points which lie beyond the extremes of the whiskers of the boxplot.</p>
</blockquote>
<blockquote>
<p>Hint: Use <code>scale_color_manual()</code> to mannually define the color scale.</p>
</blockquote>
<p>Now, we want to “control” for the influence of shortwave radiation on GPP and define outliers with respect to the distribution of <em>residuals</em> of the linear regression between the two variables. Relax the definition of what is considered an outlier by setting adjusting their definition to falling outside <span class="math inline">\(( Q_1 - 5 (Q_3 - Q_1)\)</span> to <span class="math inline">\(Q_3 + 5 (Q_3 - Q_1)\)</span>. Again, plot <code>GPP_NT_VUT_REF</code> versus shortwave radiation and highlight outliers in red.</p>
<blockquote>
<p>Hint: Fit the linear regression model as <code>lm(GPP_NT_VUT_REF ~ SW_IN_F, data = half_hourly_fluxes)</code> and obtain the residuals from the object returned by the <code>lm()</code> function (see ‘Value’ in its help page).</p>
</blockquote>
<blockquote>
<p>Hint: The output of <code>boxplot.stats(x)</code> is a list, containing an element <code>out</code>. <code>out</code> is a named vector of the oulier values with names referring to the row numbers of <code>x</code>. Use <code>as.integer(names(boxplot.stats(x)$out))</code> to get row numbers.</p>
</blockquote>
</div>
<div id="visualising-diurnal-and-seasonal-cycles-of-gpp" class="section level3 unnumbered hasAnchor">
<h3>Visualising diurnal and seasonal cycles of GPP<a href="datavis.html#visualising-diurnal-and-seasonal-cycles-of-gpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As explored in the previous Chapter’s exercises, GPP varies over diurnal and seasonal cycles. Create a publication-ready figure that visualises the mean diurnal cycle of GPP for each day-of-year (mean across multiple years). Make sure that the figure is properly labelled, and legible for readers with a color vision deficiency.</p>
<blockquote>
<p>Hint: To get the diurnal and seasonal cycles, summarise the half-hourly data by the hour of the day and the day of the year simultaneously using multiple grouping variables within <code>group_by()</code> and calculate mean values for GPP for each group.</p>
</blockquote>
<blockquote>
<p>Hint: Chose an appropriate visualisation that maps the hour-of-day to the x-axis and the day-of-year to the y-axis.</p>
</blockquote>
</div>
<div id="trend-in-carbon-dioxide-concentrations" class="section level3 unnumbered hasAnchor">
<h3>Trend in carbon dioxide concentrations<a href="datavis.html#trend-in-carbon-dioxide-concentrations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This exercise explores the longest available atmospheric CO<span class="math inline">\(_2\)</span> record, obtained at the Mauna Loa observatory in Hawaii. Atmospheric CO<span class="math inline">\(_2\)</span> in the northern hemisphere is characterised by seasonal swings, caused by the seasonal course of CO<span class="math inline">\(_2\)</span> uptake and release by the terrestrial biosphere. We’ve explored the seasonality of the CO<span class="math inline">\(_2\)</span> uptake measured at one site (in Switzerland) extensively in this an previous chapters. Your task here is to calculate and visualise the long-term trend of CO<span class="math inline">\(_2\)</span>. Follow these steps:</p>
<ul>
<li>Download the monthly mean CO2<span class="math inline">\(_2\)</span> data as a CSV file from <a href="https://gml.noaa.gov/webdata/ccgg/trends/co2/co2_mm_mlo.csv">here</a> and read it into R.</li>
<li>Make a simple graph for visualizing the monthly CO<span class="math inline">\(_2\)</span> time series.</li>
<li>Write a function that computes a 12-month running mean of the CO<span class="math inline">\(_2\)</span> time series. The running mean for month <span class="math inline">\(m\)</span> should consider values of <span class="math inline">\(m-5\)</span> to <span class="math inline">\(m+6\)</span>. Define arguments for the function that let the user specify the width of the running mean “box” (i.e., setting the <span class="math inline">\(5\)</span> and <span class="math inline">\(6\)</span> to any other integer of choice)</li>
<li>Make a publication-ready figure that shows the monthly and the 12-month running mean time series of the CO<span class="math inline">\(_2\)</span> record.</li>
</ul>
<blockquote>
<p>Hint: You don’t need to clean the .txt file by hand, find a suitable function in R.</p>
</blockquote>
<blockquote>
<p>Hint: Arguments to your function may be a vector of the original (monthly) data and a parameter defining the number of elements over which the mean is to be taken.</p>
</blockquote>
<blockquote>
<p>Hint: To automatically render the time axis with ggplot, you can create a time object by combining the year and month columns: <code>lubridate::ymd(paste(as.character(year), "-", as.character(month), "-15"))</code></p>
</blockquote>
</div>
</div>
<div id="report-exercises" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Report Exercises<a href="datavis.html#report-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="telling-a-story-from-data" class="section level3 unnumbered hasAnchor">
<h3>Telling a story from data<a href="datavis.html#telling-a-story-from-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the previous exercises and tutorials, you have learned how to wrangle data, fit simple linear regression models and identify outliers, create figures for temporal patterns, and develop and test hypotheses. Use these skills to analyze the <code>airquality</code> dataset (directly available in R, just type <code>datasets::airquality</code> into the console). The target variable of this dataset is the ozone concentration and your task is to tell a story about it. Look at the other variables in the dataset and become creative! Think of what patterns and relationships could be interesting to talk about. Your report must include the following elements:</p>
<ul>
<li>A description of the <code>airquality</code> dataset (where is it from, what are the variables’ units, etc.).</li>
<li>A specific question that you want to answer through analyzing the data.</li>
<li>At least three statistical metrics from your dataset that aid you in answering your question (e.g., mean values, ranges, etc.).</li>
<li>At least three publishable figures or tables that show important relationships that aid you in answering your question (e.g., outliers, temporal patterns, scatterplots, etc.).</li>
<li>Make sure to interpret and discuss your results and hypotheses. Why were you right / why were you wrong?</li>
</ul>
<blockquote>
<p>Important: The text alone should not exceed one A4 page (max. 400 words).
Hint: Metrics, figures, tables, etc. without any written-out explanation what they show do not count.
<!-- > Hint: Knit your file and check the html-version. Is it a readable report? If not, make it prettier and more readable! -->
Hint: To get more background information on the data, use the help functionalities in RStudio.</p>
</blockquote>
</div>
<div id="deliverables-for-the-report-1" class="section level3 unnumbered hasAnchor">
<h3>Deliverables for the report<a href="datavis.html#deliverables-for-the-report-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following the same requirements as mentioned in <a href="datawrangling.html#retidy">3.5</a>, present your solutions in a file called <code>re_airquality.Rmd</code>, save it in your <code>vignettes</code> folder alongside the HTML version, and make sure that your code is reproducible (make sure your .rmd is knittable, that all data is available, that paths to that data work, etc.).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datawrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="datavariety.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
